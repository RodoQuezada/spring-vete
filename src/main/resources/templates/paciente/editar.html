<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head th:replace="layout/layout :: head"></head>
<body onload="ocultarDiv()">

<header th:replace="layout/layout :: header"></header>

<div class="container py-4">
    <div class="card bg-light">
        <div class="card-header" th:text="${titulo}"></div>
        <div class="card-body">

            <form th:action="@{/paciente/form/}" th:object="${paciente}" method="post"  enctype="multipart/form-data">
                <div class="form-group row">
                    <label class="col-sm-2 col-form-label" th:text="'Nombre Cliente: '"></label>
                    <div class="col-sm-6">
                        <input class="form-control"
                               th:value="${paciente.cliente.nombre} + ' '+ ${paciente.cliente.apellidoPaterno}"
                               disabled="disabled"/>
                    </div>
                </div>

                <div class="form-group row">
                    <label for="nombre" class="col-sm-2 col-form-label">Nombre Paciente:</label>
                    <div class="col-sm-6">
                        <input id="nombre" type="text" th:field="*{nombre}" class="form-control"
                               th:errorclass="'form-control alert-danger'" required="true" pattern="[A-Za-z]{4-50}"/>
                        <small class="form-text text-danger" th:if="${#fields.hasErrors('nombre')}"
                               th:errors="*{nombre}"></small>
                    </div>
                </div>

                <div class="form-group row">
                    <label for="fechaNacimiento" class="col-sm-2 col-form-label">Fecha Nacimiento:</label>
                    <div class="col-sm-6">
                        <input id="fechaNacimiento" type="date" class="form-control" th:field="*{fechaNacimiento}"
                               th:errorclass="'form-control alert-danger'" required="true"/>
                        <small class="form-text text-danger" th:if="${#fields.hasErrors('fechaNacimiento')}"
                               th:errors="*{fechaNacimiento}"></small>
                    </div>
                </div>

                <div class="form-group row">
                    <label for="codigoChip" class="col-sm-2 col-form-label">Codigo Chip:</label>
                    <div class="col-sm-6">
                        <input id="codigoChip" type="text" th:field="*{codigoChip}" class="form-control"
                               th:errorclass="'form-control alert-danger'" />
                        <small class="form-text text-danger" th:if="${#fields.hasErrors('codigoChip')}"
                               th:errors="*{codigoChip}"></small>
                    </div>
                </div>

                <div class="form-group row">
                    <label for="sexo" class="col-sm-2 col-form-label">Sexo:</label>
                    <div class="col-sm-6">
                        <select class="form-control custom-select" aria-describedby="status-addon" id="sexo" th:field="*{sexo}">
                            <option th:value="'m'" th:text="'Masculino'"></option>
                            <option th:value="'f'" th:text="'Femenino'"></option>
                        </select>
                    </div>
                </div>

                <div class="form-group row">
                    <label for="especie" class="col-sm-2 col-form-label">Especie:</label>
                    <div class="col-sm-4">
                        <select id="especie" name="especie" class="form-control custom-select" th:field="*{raza.especie.id}" onchange="miFuncion()"  required="true">
                            <option th:each="especie : ${lstEspecies}"
                                    th:value="${especie.id}"
                                    th:text="${especie.nombre}">
                            </option>
                        </select>
                    </div>
                </div>

                <div class="form-group row">
                    <label for="raza" class="col-sm-2 col-form-label">Raza:</label>
                    <div class="col-sm-4">
                        <select id="raza" name="raza" class="form-control custom-select" th:field="*{raza.id}" required="true" >
                            <option th:fragment="listaDeRazasFiltrada"
                                    th:each="raza : ${listaRazas}"
                                    th:value="${raza.id}"
                                    th:text="${raza.nombre} + ' (Color: ' +  ${raza.color} + ')' "> </option>
                        </select>
                    </div>
                </div>

                <div class="form-group row">
                    <label id="textfilelabel" for="file" class="col-sm-2 col-form-label">Foto url:</label>
                    <div class="col-sm-6">
                        <input id="textfile" type="text" th:field="*{foto}" name="Textfile" class="form-control" disabled>
                    </div>

                </div>

                <div class="form-group row">
                    <label id="textfoto" for="file" class="col-sm-2 col-form-label">Foto:</label>
                    <div class="col-sm-6">
                        <input id="file" type="file" name="file" class="form-control">
                    </div>

                </div>

                <div class="form-group row align-baseline">
                    <label for="castrado" class="col-sm-2 col-form-label">Esterilizado:</label>
                    <div class="col-sm-6">
                        <input id="castrado" type="checkbox" th:field="*{castrado}" class="custom-control custom-checkbox"
                               th:errorclass="'form-control alert-danger'" />
                        <small class="form-text text-danger" th:if="${#fields.hasErrors('castrado')}"
                               th:errors="*{castrado}"></small>
                    </div>
                </div>

                <div class="form-group row align-baseline">
                    <label for="check" class="col-sm-2 col-form-label">Fallecido:</label>
                    <div class="col-sm-4">
                        <input id="check" type="checkbox"  class="custom-control custom-checkbox"
                               onchange="javascript:showContent()"/>
                    </div>
                </div>

                <div class="form-group row">
                    <label id="textoFallecido" for="fechaFallecimiento" class="col-sm-2 col-form-label">Fecha Fallecimiento:</label>
                    <div   id="content" class="col-sm-6">
                        <input id="fechaFallecimiento" type="date" class="form-control" th:field="*{fechaFallecimiento}"
                               th:errorclass="'form-control alert-danger'" />
                        <small class="form-text text-danger" th:if="${#fields.hasErrors('fechaFallecimiento')}"
                               th:errors="*{fechaFallecimiento}"></small>
                    </div>
                </div>


                <div class="card-group">
                    <h4 class="card-title">
                        <a th:href="@{'/cliente/ver/' + ${paciente.cliente.id}}" class="btn btn-light btn-xs">&laquo;
                            volver</a>
                    </h4>

                    <h4 class="card-title">
                        <a> <input type="submit" th:value="${titulo}" class="btn btn-primary btn-xs"/></a>
                    </h4>
                </div>


                <!--
                <div class="form-group row">
                    <div class="col-sm-6">
                        <input type="submit" th:value="${titulo}"
                               class="btn btn-secondary" />
                    </div>
                </div> -->

            </form>


        </div>
    </div>
</div>

<script language="JavaScript" type="text/javascript">

    function ocultarDiv() {
        // alert('funcionando al cargar la pagina ! ')

        // toma de elementos

        //input con fecha y texto de fallecido
        element = document.getElementById("content");
        textoFallecido = document.getElementById("textoFallecido");

        //input con modulo para subir foto
        fototexto = document.getElementById("textfoto");
        file = document.getElementById("file");


        //input con url de foto
        textfilelabel = document.getElementById("textfilelabel");
        textfile = document.getElementById("textfile");

        // cambios de CSS
        element.style.display='none';
        textoFallecido.style.display='none';

        if ($('#textfile').val().length == 0) {
        //    alert('no hay foto ingresada');
            textfilelabel.style.display='none';
            textfile.style.display='none';
        } else {
         //   alert('hay foto ingresada');
            fototexto.style.display='none';
            file.style.display='none';
        }


    }
    function miFuncion() {
        //alert('entra en funciona JS')
        var esp = document.getElementById("especie");
        var especieId = esp.options[esp.selectedIndex].value;
        // producccion
        //var url = '/gvetapp/paciente/cargarlistas/' + especieId;
        // desarrollo
        var url = '/paciente/cargarlistas/' + especieId;
        $("#raza").load(url);
    }


    function showContent() {
        //  alert('funcionando!')
        element = document.getElementById("content");
        check = document.getElementById("check");
        textoFallecido = document.getElementById("textoFallecido");
        if (check.checked) {
            element.style.display='block';
            textoFallecido.style.display='block';
        }
        else {
            element.style.display='none';
            textoFallecido.style.display='none';
        }
    }

</script>

<footer th:replace="layout/layout :: footer"></footer>

</body>
</html>